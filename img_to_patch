def im2patch(img, nseg=4):
  """
  Image to patch conversion fn.
  :param img: Image to convert.
  :param nseg: number of segments.
  :return: A list of image patches.
  """
  y_slide = img.shape[0] // nperseg
  x_slide = img.shape[1] // nperseg
  patches = []
  for h in range(nperseg):
    for w in range(nperseg):
      patches.append(img[(y_slide*h):(y_slide*(h+1)), (x_slide*w):(x_slide*(w+1))])
  return patches
